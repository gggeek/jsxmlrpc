if("undefined"==typeof XMLHttpRequest&&"undefined"==typeof ActiveXObject){const XMLHttpRequest=(await import("xhr2").then(module=>module?.["default"]))["XMLHttpRequest"];global.XMLHttpRequest=XMLHttpRequest}"undefined"!=typeof DOMParser||"undefined"!=typeof ActiveXObject||"undefined"!=typeof window&&"undefined"!=typeof window.parseXML||(JSDOM=(await import("jsdom"))["JSDOM"],global.DOMParser=(new JSDOM).window.DOMParser);var JSDOM="i4",xmlrpcInt="int",xmlrpcBoolean="boolean",xmlrpcDouble="double",xmlrpcString="string",xmlrpcDateTime="dateTime.iso8601",xmlrpcBase64="base64",xmlrpcArray="array",xmlrpcStruct="struct",xmlrpcValue="undefined",xmlrpcNull="null",xmlrpcTypes={xmlrpcI4:4,xmlrpcInt:4,xmlrpcBoolean:6,xmlrpcString:1,xmlrpcDouble:5,xmlrpcDateTime:7,xmlrpcBase64:8,xmlrpcArray:2,xmlrpcStruct:3,xmlrpcNull:9},xmlrpcName="XML-RPC for JAVASCRIPT",xmlrpcVersion="0.6",xmlrpcerruser=800,xmlrpcerrxml=100,xmlrpcerr={invalid_return:2,http_error:5,no_data:6,no_curl:16,multicall_error:18,no_parser:19},xmlrpcstr={invalid_return:"Invalid return payload: enable debugging to examine incoming payload",http_error:"Didn't receive 200 OK from remote server.",no_data:"No data received from server.",no_curl:"no support for executing http requests compiled in",multicall_error:"Received from server invalid multicall response",no_parser:"no support for parsing xml compiled in"},xmlrpc_null_extension=!1,xmlrpc_null_apache_encoding=!1,_xh=null,_msxml_progid=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],_msxmldoc_progid=["MSXML2.DOMDOCUMENT.6.0","MSXML2.DOMDOCUMENT.3.0","MSXML2.DOMDOCUMENT.4.0","MSXML2.DOMDOCUMENT","Microsoft.XMLDOM"];function xmlrpc_client(path,server,port,method){this.path="",this.server="",this.port=0,this.method="http",this.debug=0,this.username="",this.password="",this.no_multicall=!1,this.cookies={},this.return_type="xmlrpcvals",this.keepalive=!0,this.accepted_charset_encodings="auto",this.accepted_compression="auto",this.polling_interval=50,this.polling_queue=[],this.tid=0,this.user_agent="XML-RPC for JAVASCRIPT 0.6",this.init(path,server,port,method)}function xmlrpcval(val,type){this.me=null,this.mytype=0,this._js_class="",this.init(val,type)}function xmlrpcmsg(meth,pars){this.methodname="",this.params=[],this.payload="",this.debug=0,this.content_type="text/xml",this.init(meth,pars)}function xmlrpcresp(val,fcode=0,fstr="",valtyp){this.val=0,this.valtyp="",this.errno=0,this.errstr="",this.payload="",this.hdrs=[],this._cookies={},this.raw_data="",this.init(val,fcode,fstr,valtyp)}function xmlrpc_decode(xmlrpc_val,options){switch(xmlrpc_val.kindOf()){case"scalar":return xmlrpc_val.scalarVal();case"array":for(var size=xmlrpc_val.arraySize(),arr=[],i=0;i<size;++i)arr[arr.length]=xmlrpc_decode(xmlrpc_val.arrayMem(i),options);return arr;case"struct":var obj,key;for(key in obj=options!=undefined&&options.decode_js_objs&&""!=xmlrpc_val._js_class?new xmlrpc_val._js_class:{},xmlrpc_val.me)obj[key]=xmlrpc_decode(xmlrpc_val.me[key],options);return obj;case"msg":for(var paramcount=xmlrpc_val.getNumParams(),arr=[],i=0;i<paramcount;++i)arr[arr.length]=xmlrpc_decode(xmlrpc_val.getParam(i));return arr}}function xmlrpc_encode(js_val,options){switch(typeof js_val){case"string":xmlrpc_val=options!=undefined&&options.auto_dates&&-1!=js_val.search(/^[0-9]{8}T[0-9]{2}:[0-9]{2}:[0-9]{2}$/)?new xmlrpcval(js_val,"dateTime.iso8601"):new xmlrpcval(js_val,"string");break;case"number":var num=new Number(js_val);xmlrpc_val=num==parseInt(num)?new xmlrpcval(js_val,"int"):new xmlrpcval(js_val,"double");break;case"boolean":var xmlrpc_val=new xmlrpcval(js_val,"boolean");break;case"object":if(null===js_val)xmlrpc_val=options!=undefined&&options.null_extension?new xmlrpcval(null,"null"):new xmlrpcval;else if(js_val.toXmlRpcVal)xmlrpc_val=js_val.toXmlRpcVal();else if(js_val instanceof Array){for(var arr=[],i=0;i<js_val.length;++i)arr[arr.length]=xmlrpc_encode(js_val[i],options);xmlrpc_val=new xmlrpcval(arr,"array")}else{var attr,arr={};for(attr in js_val)"function"!=typeof js_val[attr]&&(arr[attr]=xmlrpc_encode(js_val[attr],options));xmlrpc_val=new xmlrpcval(arr,"struct")}break;default:xmlrpc_val=new xmlrpcval}return xmlrpc_val}function xmlrpc_decode_xml(xml_val,options){}function base64_decode(aString){if((aString=aString.replace(/^\s+|\s+$/g,"")).length%4!=0)return null;if("function"==typeof atob)return atob(aString);if(""==aString)return"";for(var nBits,sDecoded=[aString.length/4],base64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=0;i<aString.length;i+=4)nBits=(255&base64.indexOf(aString.charAt(i)))<<18|(255&base64.indexOf(aString.charAt(i+1)))<<12|(255&base64.indexOf(aString.charAt(i+2)))<<6|255&base64.indexOf(aString.charAt(i+3)),sDecoded[i]=String.fromCharCode((16711680&nBits)>>16,(65280&nBits)>>8,255&nBits);return sDecoded[sDecoded.length-1]=sDecoded[sDecoded.length-1].substring(0,3-(61==aString.charCodeAt(i-2)?2:61==aString.charCodeAt(i-1)?1:0)),sDecoded.join("")}function base64_encode(aString){if("function"==typeof btoa)return btoa(aString);for(var sbin,base64=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],pad=0,s=""+aString,rslt=(s.length%3==1?(s=(s+=String.fromCharCode(0))+String.fromCharCode(0),pad=2):s.length%3==2&&(s+=String.fromCharCode(0),pad=1),[s.length/3]),ri=0,i=0;i<s.length;i+=3)sbin=(255&s.charCodeAt(i))<<16|(255&s.charCodeAt(i+1))<<8|255&s.charCodeAt(i+2),rslt[ri]=base64[sbin>>18&63]+base64[sbin>>12&63]+base64[sbin>>6&63]+base64[63&sbin],ri++;return 0<pad&&(rslt[rslt.length-1]=rslt[rslt.length-1].substr(0,4-pad)+(2==pad?"==":1==pad?"=":"")),rslt.join("")}function iso8601_encode(time,utc){var y,m,d,h,min,sec,padd=function(s,p){return(s=p+s).substring(s.length-p.length)};return utc?(y=padd(time.getUTCFullYear(),"0000"),m=padd(time.getUTCMonth()+1,"00"),d=padd(time.getUTCDate(),"00"),h=padd(time.getUTCHours(),"00"),min=padd(time.getUTCMinutes(),"00"),padd(time.getUTCSeconds(),"00")):(y=padd(time.getFullYear(),"0000"),m=padd(time.getMonth()+1,"00"),d=padd(time.getDate(),"00"),h=padd(time.getHours(),"00"),min=padd(time.getMinutes(),"00"),sec=padd(time.getSeconds(),"00")),y+m+d+"T"+h+":"+min+":"+sec}function iso8601_decode(time,utc){return/^(\d{4})(\d{2})(\d{2})T(\d{2}):(\d{2}):(\d{2})$/.test(time)?utc?new Date(Date.UTC(RegExp.$1,RegExp.$2-1,RegExp.$3,RegExp.$4,RegExp.$5,RegExp.$6)):new Date(RegExp.$1,RegExp.$2-1,RegExp.$3,RegExp.$4,RegExp.$5,RegExp.$6):null}function xmlrpc_encode_entities(data,src_encoding,dest_encoding){return new String(data).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function getSingleChild(node,expectedType){for(var k,child,ret=null,i=0,j=0;i<node.childNodes.length;i++)if(1==(child=node.childNodes.item(i)).nodeType){for(k=0;k<expectedType.length;k++)if(child.tagName==expectedType[k]){ret=child;break}if(null===ret)throw"Found incorrect element inside "+node.tagName+": "+child.tagName;if(1<++j)throw"Found too many elements inside "+node.tagName}if(0==j)throw"Found no element inside "+node.tagName;return ret}function getChildText(node){for(var child,ret="",i=0;i<node.childNodes.length;i++)if(3==(child=node.childNodes.item(i)).nodeType)ret+=String(child.nodeValue);else if(1==child.nodeType)throw"elements found inside a "+node.tagName;return ret}function parseXmlrpcValue(node,return_jsvals=!1){for(var valtyp,s="",ret=null,i=0,j=0;i<node.childNodes.length;i++)if(1==(child=node.childNodes.item(i)).nodeType){switch(valtyp=child.tagName,child.tagName){case"string":ret=getChildText(child);break;case"int":case"i4":ret=-1==(ret=getChildText(child)).search(/^[+-]?[0123456789 \t]+$/)?(xmlrpc_error_log("XML-RPC: non numeric value received in INT: "+ret),"ERROR_NON_NUMERIC_FOUND"):parseInt(ret);break;case"double":ret=-1==(ret=getChildText(child)).search(/^[+-]?[eE0123456789 \t.]+$/)?(xmlrpc_error_log("XML-RPC: non numeric value received in DOUBLE: "+ret),"ERROR_NON_NUMERIC_FOUND"):parseFloat(ret);break;case"boolean":ret="1"==(ret=getChildText(child))||-1!=ret.search(/^true$/i)||("0"!=ret&&-1==ret.search(/^false$/i)&&xmlrpc_error_log("XML-RPC: invalid value received in BOOLEAN: "+ret),!1);break;case"base64":ret=base64_decode(getChildText(child));break;case"dateTime.iso8601":-1==(ret=getChildText(child)).search(/^[0-9]{8}T[0-9]{2}:[0-9]{2}:[0-9]{2}$/)&&xmlrpc_error_log("XML-RPC: invalid value received in DATETIME: "+ret);break;case"array":for(var child=getSingleChild(child,["data"]),ret=[],k=0;k<child.childNodes.length;k++)if(1==child.childNodes[k].nodeType){if("value"!=child.childNodes[k].tagName)throw"invalid element found inside array: "+child.childNodes[k].tagName;ret[ret.length]=parseXmlrpcValue(child.childNodes[k],return_jsvals)}break;case"struct":ret={};for(k=0;k<child.childNodes.length;++k)if(1==child.childNodes[k].nodeType){if("member"!=child.childNodes[k].tagName)throw"invalid element found inside struct: "+child.childNodes[k].tagName;for(var member=child.childNodes[k],membername="",memberval=undefined,l=0;l<member.childNodes.length;++l)if(1==member.childNodes[l].nodeType)switch(member.childNodes[l].tagName){case"name":membername=getChildText(member.childNodes[l]);break;case"value":memberval=parseXmlrpcValue(member.childNodes[l],return_jsvals);break;default:throw"invalid element found inside struct: "+member.childNodes[l].tagName}if(memberval===undefined)throw"invalid member found inside struct: missing value";ret[membername]=memberval}break;case"nil":case"ex:nil":if(xmlrpc_null_extension){ret=null;break}default:throw"Found incorrect element inside 'value' :"+child.tagName}if(1<++j)throw"Found too many elements inside "+node.tagName}else 3==child.nodeType&&(s+=new String(child.nodeValue));return 0==j?return_jsvals?s:new xmlrpcval(s):return_jsvals?ret:new xmlrpcval(ret,valtyp)}function xmlrpc_error_log(errormsg){"function"!=typeof xmlrpc_error_log_handler?"object"==typeof window?window.console&&"function"==typeof window.console.error?window.console.error(errormsg):window.setTimeout(function(){throw new Error(errormsg)},0):console&&"function"==typeof console.error?console.error(errormsg):"object"==typeof WScript&&WScript.Echo(logmsg):xmlrpc_error_log_handler(errormsg)}function xmlrpc_debug_log(logmsg){var el;"function"!=typeof xmlrpc_debug_log_handler?"object"==typeof window?window.console&&"function"==typeof window.console.debug?window.console.debug(logmsg):((el=document.createElement("pre")).innerHTML=logmsg,document.body.appendChild(el)):"object"==typeof console?console.debug(logmsg):"object"==typeof WScript&&WScript.Echo(logmsg.replace(/^<PRE>/g,"").replace(/<\/PRE>$/g,"")):xmlrpc_debug_log_handler(logmsg)}function htmlentities(val,quote_style){var out;return"object"==typeof window?(out=new String(val).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),0!=quote_style?out.replace(/"/g,"&quot;").replace(/'/g,"&apos;"):out):val}function var_export(val,ret,whitespaces){var type=typeof val,indent="";if(whitespaces!=undefined)for(var i=0;i<whitespaces;i++)indent+="  ";else whitespaces=0;switch(type){case"string":return"'"+val.replace(/'/g,"''")+"'";case"number":case"boolean":return val.toString();case"object":if(null===val)return"null";if(val instanceof Array){for(var arr="[\n",j=0;j<val.length;++j)arr+=indent+"  "+var_export(val[j],ret,whitespaces+1)+",\n";return arr+=indent+"]"}var attr,arr="{\n";for(attr in val)"function"!=typeof val[attr]&&(arr+=indent+"  '"+attr+"' => "+var_export(val[attr],ret,whitespaces+1)+",\n");return arr+=indent+"}";default:return indent+type}}function xmrlpc_set_option(option,value){switch(option){case"xmlrpc_null_extension":xmlrpc_null_extension=value;break;case"xmlrpc_null_apache_encoding":xmlrpc_null_apache_encoding=value;break;default:throw"Unsupportde option: "+option}}xmlrpc_client.prototype.init=function(path,server,port,method){var matches;method==undefined&&port==undefined&&server==undefined&&(path!=undefined&&-1!=path.search(/^https?:\/\/[^\/:]/)?(method=(matches=path.match(/(https?):\/\/([^\/:]+)(:\d+)?(.+)?/))[1],server=matches[2],port=matches[3]===undefined?matches[3]:matches[3].substr(1),path=matches[4]!==undefined?matches[4]:""):"undefined"!=typeof window&&(path==undefined&&(path=window.location.pathname+window.location.search),server=window.location.hostname,port=window.location.port,method="https:"==window.location.protocol?"https":"http")),path!=undefined&&(""==path||"/"!=path.substr(0,1)?this.path="/"+path:this.path=path),server!=undefined&&(this.server=server),port!=undefined&&""!=port&&(this.port=port),method!=undefined&&(this.method=method)},xmlrpc_client.prototype.setDebug=function(dbg){this.debug=dbg},xmlrpc_client.prototype.setAcceptedCompression=function(compmethod){this.accepted_compression="auto"==compmethod?compmethod:"any"==compmethod?["gzip","deflate"]:array[compmethod]},xmlrpc_client.prototype.setCredentials=function(username,password,authtype){this.username=username,this.password=password},xmlrpc_client.prototype.setUserAgent=function(agentstring){this.user_agent=agentstring},xmlrpc_client.prototype.send=function(msg,timeout,method=""){var port,asyncFunction=!1;if(""===method?method=this.method:"function"==typeof method&&(asyncFunction=method,method=this.method),port=0==this.port?"object"==typeof window&&""==window.location.port?"":"https"===method?":443":":80":":"+this.port,"object"==typeof msg&&msg instanceof Array)return this.multiCall(msg,timeout,method);"string"==typeof msg&&((n=new xmlrpcmsg("")).payload=msg,msg=n),msg.debug=this.debug;var httpconn=null;if("undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject)for(var i=0;i<_msxml_progid.length;++i)try{httpconn=new ActiveXObject(_msxml_progid[i]);break}catch(e){}try{httpconn=new XMLHttpRequest}catch(e){}if(null===httpconn)return resp=new xmlrpcresp(0,xmlrpcerr.no_curl,xmlrpcstr.no_curl),asyncFunction?(asyncFunction(resp),!1):resp;""==msg.payload&&msg.createPayload();var tid,client,n=msg.payload;1<this.debug&&xmlrpc_debug_log("<PRE>\n---SENDING---\n"+htmlentities(n)+"\n---END---\n</PRE>");try{""!=this.username?httpconn.open("POST",method+"://"+this.server+port+this.path,Boolean(asyncFunction),this.username,this.password):httpconn.open("POST",method+"://"+this.server+port+this.path,Boolean(asyncFunction))}catch(e){var httpconn=null,resp=new xmlrpcresp(0,xmlrpcerr.http_error,xmlrpcstr.http_error+" (open failed: "+e.toString()+")");return asyncFunction?(asyncFunction(resp),!1):resp}try{"auto"!=this.accepted_compression&&httpconn.setRequestHeader("Accept-Encoding",this.accepted_compression.join(",")),httpconn.setRequestHeader("User-Agent",this.user_agent),httpconn.setRequestHeader("Content-type",msg.content_type),httpconn.setRequestHeader("Accept",msg.content_type),"auto"!=this.accepted_charset_encodings&&httpconn.setRequestHeader("Accept-Charset",this.accepted_charset_encodings.join(",")),this.keepalive||(httpconn.setRequestHeader("Keep-Alive",""),httpconn.setRequestHeader("Connection","close"))}catch(e){}asyncFunction&&(0<timeout?(tid=(client=this).tid,this.polling_queue[this.tid]=[],this.polling_queue[this.tid][0]=setTimeout(function(){clearInterval(client.polling_queue[tid][1]),delete client.polling_queue[tid][1],delete client.polling_queue[tid][0],client.handleTransaction(msg,httpconn,asyncFunction,!0)},1e3*timeout),this.polling_queue[this.tid][1]=setInterval(function(){4==httpconn.readyState&&(clearInterval(client.polling_queue[tid][1]),clearTimeout(client.polling_queue[tid][0]),delete client.polling_queue[tid][1],delete client.polling_queue[tid][0],client.handleTransaction(msg,httpconn,asyncFunction,!1))},this.polling_interval),++this.tid):(client=this,httpconn.onreadystatechange=function(){var resp;4==httpconn.readyState&&(resp=200!=httpconn.status?new xmlrpcresp(0,xmlrpcerr.http_error,xmlrpcstr.http_error+" (HTTP "+httpconn.status+" "+httpconn.statusText+")"):msg.parseResponse(httpconn.responseText,httpconn.getAllResponseHeaders(),client.return_type),httpconn=null,asyncFunction(resp))}));try{httpconn.send(n)}catch(e){httpconn=null;var resp=new xmlrpcresp(0,xmlrpcerr.http_error,xmlrpcstr.http_error+" (send failed: "+e.toString()+")");return asyncFunction?(asyncFunction(resp),!1):resp}return asyncFunction?void 0:(resp=200!=httpconn.status?new xmlrpcresp(0,xmlrpcerr.http_error,xmlrpcstr.http_error+" ( HTTP "+httpconn.status+" "+httpconn.statusText+")"):msg.parseResponse(httpconn.responseText,httpconn.getAllResponseHeaders(),this.return_type),httpconn=null,resp)},xmlrpc_client.prototype.handleTransaction=function(msg,httpconn,callback,is_timeout){callback(is_timeout?(httpconn.abort(),new xmlrpcresp(0,xmlrpcerr.http_error,xmlrpcstr.http_error+" (send timeout)")):200!=httpconn.status?new xmlrpcresp(0,xmlrpcerr.http_error,xmlrpcstr.http_error+" ( HTTP "+httpconn.status+" "+httpconn.statusText+")"):msg.parseResponse(httpconn.responseText,httpconn.getAllResponseHeaders(),this.return_type))},xmlrpc_client.prototype.multiCall=function(messages,timeout,method,fallback=!0){if(method==undefined&&(method=this.method),this.no_multicall)fallback=!0;else{var results,result;if((results=this._try_multicall(messages,timeout,method))instanceof Array)return results;fallback?this.no_multicall=!0:result=results instanceof xmlrpcresp?results:new xmlrpcresp(0,xmlrpcerr.multicall_error,xmlrpcstr.multicall_error)}if(results=[],fallback)for(var i=0;i<messages.length;++i)results[results.length]=this.send(messages[i],timeout,method);else for(i=0;i<messages.length;++i)results[results.length]=result;return results},xmlrpc_client.prototype._try_multicall=function(msgs,timeout,method){for(var msg,calls=[],call={},i=0;i<msgs.length;++i){msg=msgs[i],call.methodName=new xmlrpcval(msgs.method(),"string");for(var numParams=msg.getNumParams(),params=[],j=0;j<numParams;++j)params[j]=msg.getParam(j);call.params=new xmlrpcval(params,"array"),calls[i]=new xmlrpcval(call,"struct")}var multicall=new xmlrpcmsg("system.multicall"),multicall=(multicall.addParam(new xmlrpcval(calls,"array")),this.send(multicall,timeout,method));if(0!=multicall.faultCode())return multicall;var numRets,rets=multicall.value();if("xml"==this.return_type)return rets;if("jsvals"==this.return_type){if(!(rets=multicall.value())instanceof Array)return!1;if((numRets=rets.length)!=msgs.length)return!1;for(var response=[],i=0;i<numRets;++i)switch((val=rets[i]).length){case 1:if(val[0]===undefined)return!1;response[i]=new xmlrpcresp(val[0],0,"","jsvals");break;case 2:try{if("number"!=typeof(code=val.faultCode))return!1;if("string"!=typeof(str=val.faultString))return!1;response[i]=new xmlrpcresp(0,code,str)}catch(e){return!1}break;default:return!1}}else{if("array"!=(rets=multicall.value()).kindOf())return!1;if((numRets=rets.arraysize())!=msgs.length)return!1;var val,code,str,response=[];for(i=0;i<numRets;++i)switch((val=rets.arraymem(i)).kindOf()){case"array":if(1!=val.arraySize())return!1;response[i]=new xmlrpcresp(val.arrayMem(0));break;case"struct":if("scalar"!=(code=val.structmem("faultCode")).kindOf()||"int"!=code.scalarTyp())return!1;if("scalar"!=(str=val.structmem("faultString")).kindOf()||"string"!=str.scalarTyp())return!1;response[i]=new xmlrpcresp(0,code.scalarVal(),str.scalarVal());break;default:return!1}}return response},xmlrpcval.prototype.init=function(val,type){if(val!==undefined)switch(this.me=val,type){case"string":case undefined:case"":this.mytype=1;break;case"i4":case"int":this.mytype=4;break;case"double":this.mytype=5;break;case"boolean":this.mytype=6;break;case"dateTime.iso8601":this.mytype=7;break;case"base64":this.mytype=8;break;case"null":this.mytype=9;break;case"array":this.mytype=2;break;case"struct":this.mytype=3,this.myidx=0;break;default:xmlrpc_error_log("XML-RPC: xmlrpcval::xmlrpcval: not a known type ("+type+")")}},xmlrpcval.prototype.addScalar=function(val,type="string"){if(xmlrpcTypes[type]===undefined)return xmlrpc_error_log("XML-RPC: xmlrpcval::addScalar: not a scalar type ("+type+")"),0;switch(this.mytype){case 0:return this.me=val,this.mytype=xmlrpcTypes[type],1;case 2:return this.me[this.me.length]=new xmlrpcval(val,type),1;case 3:return xmlrpc_error_log("XML-RPC: xmlrpcval::addScalar: cannot add anonymous scalar to struct xmlrpcval"),0;default:return xmlrpc_error_log("XML-RPC: xmlrpcval::addScalar: scalar xmlrpcval can have only one value"),0}},xmlrpcval.prototype.addArray=function(vals){if(0==this.mytype)this.mytype=2,this.me=vals;else{if(2!=this.mytype)return 0;for(var i=0;i<vals.length;i++)this.me[this.me.length]=vals[i]}return 1},xmlrpcval.prototype.addStruct=function(vals){if(0==this.mytype)this.mytype=3,this.me=vals,this.myidx=0;else{if(3!=this.mytype)return 0;for(var i in vals)this.me[i]=vals[i]}return 1},xmlrpcval.prototype.kindOf=function(){switch(this.mytype){case 3:return"struct";case 2:return"array";case 0:return"undef";default:return"scalar"}},xmlrpcval.prototype.serialize=function(charset_encoding){switch(this.mytype){case 1:var result="<string>"+xmlrpc_encode_entities(this.me)+"</string>";break;case 4:result=isFinite(this.me)&&null!==this.me?"<int>"+this.me.toFixed()+"</int>":"<int>0</int>";break;case 5:result=isFinite(this.me)&&null!==this.me?"<double>"+this.me.toString()+"</double>":"<double>0</double>";break;case 6:result=this.me?"<boolean>1</boolean>":"<boolean>0</boolean>";break;case 7:result="<dateTime.iso8601>"+this.me+"</dateTime.iso8601>";break;case 8:result="<base64>"+base64_encode(this.me)+"</base64>";break;case 9:result=xmlrpc_null_apache_encoding?"<ex:nil/>":"<nil/>";break;case 2:for(var result="<array>\n<data>\n",i=0;i<this.me.length;i++)result+=this.me[i].serialize(charset_encoding);result+="</data>\n</array>";break;case 3:var attr,result="<struct>\n";for(attr in this.me)result=result+"<member><name>"+xmlrpc_encode_entities(attr)+"</name>\n"+this.me[attr].serialize(charset_encoding)+"</member>\n";result+="</struct>";break;default:result=""}return"<value>"+result+"</value>\n"},xmlrpcval.prototype.structMemExists=function(m){for(var attr in this.me)if(attr==m)return!0;return!1},xmlrpcval.prototype.structMem=function(m){return this.me[m]},xmlrpcval.prototype.structReset=function(){this.myidx=0},xmlrpcval.prototype.structEach=function(){++this.myidx;var attr,i=0;for(attr in this.me)if(++i==this.myidx)return{0:attr,1:this.me[attr],key:attr,value:this.me[attr]};return!1},xmlrpcval.prototype.scalarVal=function(){return this.me},xmlrpcval.prototype.scalarTyp=function(){switch(this.mytype){case 3:return"struct";case 2:return"array";case 1:return"string";case 4:return"int";case 5:return"double";case 6:return"boolean";case 7:return"dateTime.iso8601";case 8:return"base64";case 9:return"null";case 0:return"undef";default:return"undef: "+this.mytype}},xmlrpcval.prototype.arrayMem=function(m){return this.me[m]},xmlrpcval.prototype.arraySize=function(){return this.me.length},xmlrpcval.prototype.structSize=function(){var attr,i=0;for(attr in this.me)++i;return i},xmlrpcval.prototype.toXmlRpcVal=function(){return this},xmlrpcmsg.prototype.init=function(meth,pars=null){if(this.methodname=meth,null!==pars)for(var i=0;i<pars.length;++i)this.addParam(pars[i])},xmlrpcmsg.prototype.kindOf=function(){return"msg"},xmlrpcmsg.prototype.xml_header=function(charset_encoding){return charset_encoding!=undefined&&""!=charset_encoding?'<?xml version="1.0" encoding="'+charset_encoding+'" ?>\n<methodCall>\n':'<?xml version="1.0"?>\n<methodCall>\n'},xmlrpcmsg.prototype.xml_footer=function(){return"</methodCall>"},xmlrpcmsg.prototype.createPayload=function(charset_encoding){charset_encoding!=undefined&&""!=charset_encoding?this.content_type="text/xml; charset="+charset_encoding:this.content_type="text/xml",this.payload=this.xml_header(charset_encoding),this.payload=this.payload+"<methodName>"+xmlrpc_encode_entities(this.methodname)+"</methodName>\n",this.payload=this.payload+"<params>\n";for(var i=0;i<this.params.length;i++)this.payload=this.payload+"<param>\n"+this.params[i].serialize(charset_encoding)+"</param>\n";this.payload=this.payload+"</params>\n",this.payload=this.payload+this.xml_footer()},xmlrpcmsg.prototype.method=function(meth){return meth!=undefined&&""!=meth&&(this.methodname=meth),this.methodname},xmlrpcmsg.prototype.serialize=function(charset_encoding){return this.createPayload(charset_encoding),this.payload},xmlrpcmsg.prototype.addParam=function(par){return"object"==typeof par&&(this.params[this.params.length]=par,!0)},xmlrpcmsg.prototype.getParam=function(i){return this.params[i]},xmlrpcmsg.prototype.getNumParams=function(){return this.params.length},xmlrpcmsg.prototype.parseResponseHeaders=function(data,headers_processed=0){var pos,bd,errstr,line,arr;if(-1!=data.search(/^HTTP\/1\.[0-1] 200 Connection established/)){if(!(bd=-1!=(pos=data.indexOf("\r\n\r\n"))?pos+4:-1!=(pos=data.indexOf("\n\n"))?pos+2:0))return xmlrpc_error_log("XML-RPC: xmlrpcmsg::parseResponse: HTTPS via proxy error, tunnel connection possibly failed"),new xmlrpcresp(0,xmlrpcerr.http_error,xmlrpcstr.http_error+" (HTTPS via proxy error, tunnel connection possibly failed)");data=data.slice(bd)}for(;-1!=data.search(/^HTTP\/1\.1 1[0-9]{2} /)&&-1!=(pos=data.indexOf("HTTP",12));)data=data.substr(pos);if(null!=(ar=data.match(/^HTTP\/[0-9.]+ ([0-9]{3}) /))&&"200"!=ar[0])return xmlrpc_error_log("XML-RPC: xmlrpcmsg::parseResponse: HTTP error, got response: "+(errstr=-1!=data.indexOf("\n")?data.substring(0,data.indexOf("\n")-1):data)),new xmlrpcresp(0,xmlrpcerr.http_error,xmlrpcstr.http_error+" ("+errstr+")");_xh.headers={},_xh.cookies={},-1!=(pos=data.indexOf("\r\n\r\n"))?bd=pos+4:-1!=(pos=data.indexOf("\n\n"))?bd=pos+2:(bd=0,pos=data.length);for(var ar=data.substring(0,pos).replace(/^\s/,"").replace(/\s$/,"").split(/\r?\n/),i=0;i<ar.length;++i)if(1<(arr=(line=ar[i]).split(":")).length){for(var j=2;j<arr.length;++j)arr[1]+=":"+arr[j];var cookies,header_name=arr[0].replace(/^\s/,"").replace(/\s$/,"").toLowerCase();if("set-cookie"==header_name||"set-cookie2"==header_name)for(cookies="set-cookie2"==header_name?arr[1].split(","):[arr[1]],j=0;j<cookies.length;++j){var cookie=cookies[j];_xh.headers[header_name]!==undefined?_xh.headers[header_name]+=", "+cookie.replace(/^\s/,"").replace(/\s$/,""):_xh.headers[header_name]=cookie.replace(/^\s/,"").replace(/\s$/,"");for(var cookie=cookie.split(";"),k=0;k<cookie.length;++k){if(1==(val=cookie[k].split("=")).length)val[1]="";else if(1<val.length)for(var l=2;l<val.length;++l)val[1]+="="+val[l];var cookiename,tag=val[0].replace(/^\s/,"").replace(/\s$/,""),val=val[1].replace(/^\s/,"").replace(/\s$/,"");0==k?(_xh.cookies[cookiename=tag]=[],_xh.cookies[cookiename].value=decodeURIComponent(val)):_xh.cookies[cookiename][tag]=val}}else _xh.headers[header_name]=arr[1].replace(/^\s/,"").replace(/\s$/,"")}else header_name!==undefined&&(_xh.headers[header_name]+=" "+line.replace(/^\s/,"").replace(/\s$/,""));if(data=data.slice(0,bd),this.debug){for(i in xmlrpc_debug_log("<PRE>"),_xh.headers)xmlrpc_debug_log(htmlentities("HEADER: "+i+": "+_xh.headers[i]));for(i in _xh.cookies)xmlrpc_debug_log(htmlentities("COOKIE: "+i+"="+_xh.cookies[i]));xmlrpc_debug_log("</PRE>")}return data},xmlrpcmsg.prototype.parseResponse=function(data,headers_processed=!1,return_type="xmlrpcvals"){var headers="";if("string"==typeof headers_processed&&(headers=headers_processed,headers_processed=!0),this.debug&&xmlrpc_debug_log("<PRE>---GOT---\n"+htmlentities(data)+"\n---END---\n</PRE>"),""==data)return xmlrpc_error_log("XML-RPC: xmlrpcmsg::parseResponse: no response received from server."),new xmlrpcresp(0,xmlrpcerr.no_data,xmlrpcstr.no_data);_xh={headers:[],cookies:{}};var raw_data=data;if(""!=headers)var r=this.parseResponseHeaders(headers,!0);else if("HTTP"==data.slice(0,4)){if("string"!=typeof(r=this.ParseResponseHeaders(data,headers_processed)))return r.raw_data=data,r;data=r}this.debug&&-1!=(headers=data.indexOf("\x3c!-- SERVER DEBUG INFO (BASE64 ENCODED):"))&&(end=data.indexOf("--\x3e",headers+=41),xmlrpc_debug_log("<PRE>---SERVER DEBUG INFO (DECODED)---\n\t"+htmlentities(base64_decode(data.slice(headers,end-1)).replace(/\n/g,"\n\t"))+"\n---END---\n</PRE>"));headers=(data=data.replace(/^\s/,"").replace(/\s$/,"")).lastIndexOf("</methodResponse>");if(0<=headers&&(data=data.slice(0,headers+17)),"xml"==return_type)return(r=new xmlrpcresp(data,0,"","xml")).hdrs=_xh.headers,r._cookies=_xh.cookies,r.raw_data=raw_data,r;var parser=null,end=!1,isIE=!1,headers=!1;if("undefined"==typeof DOMParser)if("object"==typeof window&&"undefined"!=typeof window.parseXML)headers=!0;else if("undefined"!=typeof ActiveXObject)for(var i=0;i<_msxmldoc_progid.length;++i)try{parser=new ActiveXObject(_msxmldoc_progid[i]),isIE=!0;break}catch(e){}if(!headers&&!isIE)try{parser=new DOMParser,end=!0}catch(e){}if(!isIE&&!end&&!headers)return(r=new xmlrpcresp(0,xmlrpcerr.no_parser,xmlrpcstr.no_parser)).hdrs=_xh.headers,r._cookies=_xh.cookies,r.raw_data=raw_data,r;try{end?parser=parser.parseFromString(data,"text/xml"):isIE?parser.loadXML(data):headers&&(parser=window.parseXML(data,null))}catch(e){return xmlrpc_error_log("XML Error: "+e.toString()),this.debug&&xmlrpc_debug_log("XML Error: "+e.toString()),(r=new xmlrpcresp(0,xmlrpcerr.invalid_return,xmlrpcstr.invalid_return+" ("+e.toString()+")")).hdrs=_xh.headers,r._cookies=_xh.cookies,r.raw_data=raw_data,r}try{var value,node=parser.documentElement;if(null==node)throw"No documentElement found.";if("methodResponse"!==node.tagName)throw"missing top level xmlrpc element";return r="fault"==(node=getSingleChild(node,["params","fault"])).tagName?"object"==typeof(value=parseXmlrpcValue(node=getSingleChild(node,["value"]),!0))&&value.hasOwnProperty("faultCode")&&value.hasOwnProperty("faultString")?(0==value.faultCode&&(value.faultCode=-1),new xmlrpcresp(0,value.faultCode,value.faultString)):new xmlrpcresp(0,xmlrpcerr.invalid_return,xmlrpcstr.invalid_return+" (malformed fault response)"):(node=getSingleChild(node,["param"]),new xmlrpcresp(value=parseXmlrpcValue(node=getSingleChild(node,["value"]),"jsval"==return_type),0,"",return_type)),this.debug&&(xmlrpc_debug_log("<PRE>---PARSED---"),xmlrpc_debug_log(htmlentities(var_export(value))),xmlrpc_debug_log("\n---END---</PRE>")),r.hdrs=_xh.headers,r._cookies=_xh.cookies,r.raw_data=raw_data,r}catch(e){return this.debug,(r=new xmlrpcresp(0,xmlrpcerr.invalid_return,xmlrpcstr.invalid_return+" ("+e.toString()+")")).hdrs=_xh.headers,r._cookies=_xh.cookies,r.raw_data=raw_data,r}},xmlrpcresp.prototype.init=function(val,fcode=0,fstr="",valtyp){fcode!=undefined&&0!=fcode?(this.errno=fcode,this.errstr=fstr):(this.val=val,valtyp==undefined?this.valtyp="object"==typeof val?"xmlrpcvals":"string"==typeof val?"xml":"jsvals":this.valtyp=valtyp)},xmlrpcresp.prototype.faultCode=function(){return this.errno},xmlrpcresp.prototype.faultString=function(){return this.errstr},xmlrpcresp.prototype.value=function(){return this.val},xmlrpcresp.prototype.cookies=function(){return this._cookies},xmlrpcresp.prototype.xml_header=function(charset_encoding){return charset_encoding!=undefined&&""!=charset_encoding?'<?xml version="1.0" encoding="'+charset_encoding+'" ?>\n<methodResponse>\n':'<?xml version="1.0"?>\n<methodResponse>\n'},xmlrpcresp.prototype.serialize=function(charset_encoding){var result=this.xml_header(charset_encoding);return this.errno?result+="<fault>\n<value>\n<struct><member><name>faultCode</name>\n<value><int>"+this.errno+"</int></value>\n</member>\n<member>\n<name>faultString</name>\n<value><string>"+xmlrpc_encode_entities(this.errstr)+"</string></value>\n</member>\n</struct>\n</value>\n</fault>":"object"!=typeof this.val?"string"==typeof this.val&&"xml"==this.valtyp&&(result+="<params>\n<param>\n"+this.val+"</param>\n</params>"):result+="<params>\n<param>\n"+this.val.serialize(charset_encoding)+"</param>\n</params>",this.payload=result+="\n</methodResponse>"},String.prototype.toXmlRpcVal=function(options){return new xmlrpcval(this.toString())},Number.prototype.toXmlRpcVal=function(options){return this==parseInt(this)?new xmlrpcval(this.valueOf(),"int"):new xmlrpcval(this.valueOf(),"double")},Boolean.prototype.toXmlRpcVal=function(options){return new xmlrpcval(this.valueOf(),"boolean")},Date.prototype.toXmlRpcVal=function(options){return new xmlrpcval(iso8601_encode(this),"dateTime.iso8601")};var xh={get cookies(){return _xh.cookies},get headers(){return _xh.headers},get isf(){return _xh.isf},get isf_reason(){return _xh.isf_reason},get value(){return _xh.value},set cookies(val){_xh.cookies=val},set headers(val){_xh.headers=val},set isf(val){_xh.isf=val},set isf_reason(val){_xh.isf_reason=val},set reset(val){_xh=val},set value(val){_xh.value=val}};export{JSDOM as xmlrpcI4,xmlrpcInt,xmlrpcBoolean,xmlrpcDouble,xmlrpcString,xmlrpcDateTime,xmlrpcBase64,xmlrpcArray,xmlrpcStruct,xmlrpcValue,xmlrpcNull,xmlrpcTypes,xmlrpcName,xmlrpcVersion,xmlrpcerruser,xmlrpcerrxml,xmlrpcerr,xmlrpcstr,xmlrpc_client,xmlrpcval,xmlrpcmsg,xmlrpcresp,xmlrpc_decode,xmlrpc_encode,xmlrpc_decode_xml,base64_decode,base64_encode,iso8601_encode,iso8601_decode,xmlrpc_encode_entities,xmlrpc_error_log,xmlrpc_debug_log,htmlentities,var_export,xmrlpc_set_option,xh};
//# sourceMappingURL=xmlrpc_lib.js.map